name: timedatecalculator
base: core20
version: "6.4.27"
summary: Calculates times and time spans
description: |
  timedatecalculator
  calculates time and date from start-/end time
  and time span or time span from start- and end time and date
grade: stable # must be 'stable' to release into candidate/stable channels
confinement: strict # use 'strict' once you have the right plugs and slots
# confinement: devmode # use 'strict' once you have the right plugs and slots
# grade: stable # must be 'stable' to release into candidate/stable channels
# confinement: strict # use 'strict' once you have the right plugs and slots
# confinement: devmode # use 'strict' once you have the right plugs and slots

# architectures:
#   - build-on: amd64
#   - build-on: s390x
#   - build-on: arm64
#   - build-on: armhf
#   - build-on: i386
# package-repositories:
#   - type: apt
#     formats: [deb]
#     components: [main]
#     suites: [stable-focal]
#     key-id: 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF
#     url: https://download.mono-project.com/repo/ubuntu

layout:
  /usr/lib/cli/gdk-sharp-2.0:
    bind: $SNAP/usr/lib/cli/gdk-sharp-2.0
  /usr/lib/cli/gtk-sharp-2.0:
    bind: $SNAP/usr/lib/cli/gtk-sharp-2.0
  /usr/lib/cli/glib-sharp-2.0:
    bind: $SNAP/usr/lib/cli/glib-sharp-2.0
  $SNAP/usr/lib/cli/gtk-sharp-2.0/libgtk-x11-2.0.so.0:
    symlink: $SNAP/usr/lib/x86_64-linux-gnu/libgtk-x11-2.0.so.0
  $SNAP/usr/lib/cli/gtk-sharp-2.0/libgtk-x11-2.0.so.0.so:
    symlink: $SNAP/usr/lib/x86_64-linux-gnu/libgtk-x11-2.0.so.0
  $SNAP/usr/lib/cli/gtk-sharp-2.0/libMonoSupportW.so:
    symlink: $SNAP/usr/lib/libMonoSupportW.so
  $SNAP/usr/lib/cli/glib-sharp-2.0/libglib-2.0.so.0:
    symlink: $SNAP/usr/lib/x86_64-linux-gnu/libglib-2.0.so.0
  $SNAP/usr/lib/cli/glib-sharp-2.0/libgobject-2.0.so.0:
    symlink: $SNAP/usr/lib/x86_64-linux-gnu/libgobject-2.0.so.0
  /usr/lib/cli/pango-sharp-2.0:
    symlink: $SNAP/usr/lib/cli/pango-sharp-2.0
#  /usr/lib/cli/pango-sharp-2.0/libpangosharpglue-2.so:
#    symlink: $SNAP/usr/lib/cli/pango-sharp-2.0/libpangosharpglue-2.so
#  $SNAP/usr/lib/cli/glib-sharp-2.0/libglibsharpglue-2.so:
#    symlink: $SNAP/usr/lib/cli/glib-sharp-2.0/libglibsharpglue-2.so
#  /etc/fonts/conf.d:
#    bind: $SNAP/etc/fonts/conf.d
#  /etc/fonts/conf.d/10-hinting-slight.conf:
#    symlink: $SNAP/etc/fonts/conf.d/10-hinting-slight.conf
#  /etc/fonts/conf.d/10-scale-bitmap-fonts.conf:
#    symlink: $SNAP/etc/fonts/conf.d/10-scale-bitmap-fonts.conf
#  /etc/fonts/conf.d/11-lcdfilter-default.conf:
#    symlink: $SNAP/etc/fonts/conf.d/11-lcdfilter-default.conf
#  /etc/fonts/conf.d/20-unhint-small-vera.conf:
#    symlink: $SNAP/etc/fonts/conf.d/20-unhint-small-vera.conf
#  /etc/fonts/conf.d/30-metric-aliases.conf:
#    symlink: $SNAP/etc/fonts/conf.d/30-metric-aliases.conf
#  /etc/fonts/conf.d/40-nonlatin.conf:
#    symlink: $SNAP/etc/fonts/conf.d/40-nonlatin.conf
#  /etc/fonts/conf.d/45-generic.conf:
#    symlink: $SNAP/etc/fonts/conf.d/45-generic.conf
#  /etc/fonts/conf.d/45-latin.conf:
#    symlink: $SNAP/etc/fonts/conf.d/45-latin.conf
#  /etc/fonts/conf.d/49-sansserif.conf:
#    symlink: $SNAP/etc/fonts/conf.d/49-sansserif.conf
#  /etc/fonts/conf.d/50-user.conf:
#    symlink: $SNAP/etc/fonts/conf.d/50-user.conf
#  /etc/fonts/conf.d/51-local.conf:
#    symlink: $SNAP/etc/fonts/conf.d/51-local.conf
#  /etc/fonts/conf.d/60-generic.conf:
#    symlink: $SNAP/etc/fonts/conf.d/60-generic.conf
#  /etc/fonts/conf.d/60-latin.conf:
#    symlink: $SNAP/etc/fonts/conf.d/60-latin.conf
#  /etc/fonts/conf.d/65-fonts-persian.conf:
#    symlink: $SNAP/etc/fonts/conf.d/65-fonts-persian.conf
#  /etc/fonts/conf.d/65-nonlatin.conf:
#    symlink: $SNAP/etc/fonts/conf.d/65-nonlatin.conf
#  /etc/fonts/conf.d/69-unifont.conf:
#    symlink: $SNAP/etc/fonts/conf.d/69-unifont.conf
#  /etc/fonts/conf.d/70-no-bitmaps.conf:
#    symlink: $SNAP/etc/fonts/conf.d/70-no-bitmaps.conf
#  /etc/fonts/conf.d/80-delicious.conf:
#    symlink: $SNAP/etc/fonts/conf.d/80-delicious.conf
#  /etc/fonts/conf.d/90-synthetic.conf:
#    symlink: $SNAP/etc/fonts/conf.d/90-synthetic.conf

environment:
  MONO_CFG_DIR: $SNAP/etc
  MONO_CONFIG: $SNAP/etc/mono/config
  MONO_GAC_PREFIX: $SNAP/usr/lib/mono
  MONO_PATH: $SNAP/usr/lib/x86_64-linux-gnu:$SNAP/gnome-platform/usr/lib/x86_64-linux-gnu:$SNAP/etc/mono:$SNAP/usr/bin:$SNAP/usr/lib:$SNAP/usr/lib/mono:$SNAP/usr/share/mono:$SNAP/usr/lib/cli:$SNAP/usr/lib/cli/atk-sharp-2.0:$SNAP/usr/lib/cli/gdk-sharp-2.0:$SNAP/usr/lib/cli/gtk-sharp-2.0:$SNAP/usr/lib/cli/glib-sharp-2.0
# MONO_PATH: $SNAP/etc/mono:$SNAP/usr/bin:$SNAP/usr/lib:$SNAP/usr/lib/mono:$SNAP/usr/share/mono:$SNAP/usr/lib/cli:$SNAP/usr/lib/x86_64-linux-gnu/libgtk-x11-2.0.so.0:$SNAP/usr/lib/x86_64-linux-gnu:$SNAP/usr/lib/cli/gtk-sharp-2.0:$SNAP/usr/lib/cli/glib-sharp-2.0:$SNAP/usr/lib/cli/atk-sharp-2.0:$SNAP/usr/lib/cli/gdk-sharp-2.0
  MONO_LOG_LEVEL: debug
  # MONO_LOG_MASK: dll

# package-repositories:
#   - type: apt
#     formats: [deb]
#     components: [main]
#     suites: [vs-bionic]
#     key-id: 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF
#     url: https://download.mono-project.com/repo/ubuntu

package-repositories:
  - type: apt
    formats: [deb]
    components: [main]
    suites: [stable-focal]
    key-id: 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF
    url: https://download.mono-project.com/repo/ubuntu

parts:
  timedatecalculator:
    # after: [monoinstall]
    source: .
    plugin: nil
    override-build: |
      cp ./eksfind.sh $SNAPCRAFT_PART_INSTALL/
      cp ./ekstxtfind.sh $SNAPCRAFT_PART_INSTALL/
#      nuget restore
#      cd TimeDateCalculator/TimeDateCalculator.gtk
#      msbuild -t:Rebuild -p:Configuration=debug
#      cd bin/Debug
      cd Debug
      cp -rf ./* $SNAPCRAFT_PART_INSTALL/
    build-packages:
      - curl
      - nuget
      - apt-transport-https
      - dirmngr
      - libgtk2.0-cil-dev
      - mono-devel
      # - mono-complete
      # - monodevelop
      - msbuild
    stage-packages:
      - ca-certificates-mono
      # - libfreetype6
      # - libgdiplus
      # - libglu1-mesa
      # - liblttng-ust0
      # - liblua5.1-0
      # - libopenal1
      # - libsdl2-2.0-0
      # - libgtk2.0-0
      - libuser
      - libgail-common
      - libgail-3-0
      - libatk-bridge2.0-0
      - libglib2.0-0
      - mono-runtime
      - mono-runtime-sgen
      # - mono-llvm-support
      - libmono-2.0-1
      - libmono-profiler
      - mono-utils
      - mono-devel
      - mono-mcs
      # - mono-roslyn
      - mono-csharp-shell
      - mono-4.0-gac
      - mono-4.0-service
      - monodoc-base
      - monodoc-manual
      - libmono-cil-dev
      # - referenceassemblies-pcl
      # - msbuild
      - mono-complete
      - gtk-sharp2
      - libgtk2.0-cil

apps:
  timedatecalculator:
    extensions: [gnome-3-38]
    command: usr/bin/mono $SNAP/TimeDateCalculator.gtk.exe
    # adapter: none
    # plugs: 
    #   - home
    #   - x11
    #   - desktop
    #   - desktop-legacy
    #   - gsettings
    #   - opengl
